{
  "id": null,
  "uid": "43v3r-tech-ops",
  "title": "43v3r Technology Ops",
  "timezone": "browser",
  "schemaVersion": 38,
  "version": 1,
  "refresh": "30s",
  "panels": [
    {
      "type": "table",
      "title": "Open Tasks by Status (Tech)",
      "datasource": { "type": "postgres", "uid": "supabase" },
      "targets": [
        {
          "format": "table",
          "rawSql": "SELECT\n  t.status,\n  COUNT(*) AS count\nFROM tasks t\nJOIN brands b ON t.brand_id = b.id\nWHERE b.slug = 'tech'\n  AND t.status IN ('todo', 'in_progress', 'blocked')\nGROUP BY t.status\nORDER BY count DESC;",
          "refId": "A"
        }
      ],
      "gridPos": { "x": 0, "y": 0, "w": 12, "h": 8 }
    },
    {
      "type": "timeseries",
      "title": "Tasks Created vs Completed (30d, Tech)",
      "datasource": { "type": "postgres", "uid": "supabase" },
      "targets": [
        {
          "format": "time_series",
          "rawSql": "WITH created AS (\n  SELECT\n    date_trunc('day', t.created_at) AS day,\n    COUNT(*) AS created_count\n  FROM tasks t\n  JOIN brands b ON t.brand_id = b.id\n  WHERE b.slug = 'tech'\n    AND t.created_at >= now() - interval '30 days'\n  GROUP BY day\n),\ncompleted AS (\n  SELECT\n    date_trunc('day', t.updated_at) AS day,\n    COUNT(*) AS completed_count\n  FROM tasks t\n  JOIN brands b ON t.brand_id = b.id\n  WHERE b.slug = 'tech'\n    AND t.status = 'done'\n    AND t.updated_at >= now() - interval '30 days'\n  GROUP BY day\n)\nSELECT\n  COALESCE(c.day, d.day) AS time,\n  COALESCE(created_count, 0) AS created,\n  COALESCE(completed_count, 0) AS completed\nFROM created c\nFULL OUTER JOIN completed d ON c.day = d.day\nORDER BY time;",
          "refId": "A"
        }
      ],
      "gridPos": { "x": 12, "y": 0, "w": 12, "h": 8 }
    },
    {
      "type": "table",
      "title": "Tech Projects by Stage",
      "datasource": { "type": "postgres", "uid": "supabase" },
      "targets": [
        {
          "format": "table",
          "rawSql": "SELECT\n  p.stage,\n  COUNT(*) AS count\nFROM projects p\nJOIN brands b ON p.brand_id = b.id\nWHERE b.slug = 'tech'\nGROUP BY p.stage\nORDER BY count DESC;",
          "refId": "A"
        }
      ],
      "gridPos": { "x": 0, "y": 8, "w": 12, "h": 8 }
    },
    {
      "type": "timeseries",
      "title": "AI Runs by Agent (Tech, 24h)",
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "expr": "sum by (agent) (increase(ai_runs_total{agent=~\"tech_ops_agent|daily_planner_agent|revenue_agent\"}[24h]))",
          "legendFormat": "{{agent}}"
        }
      ],
      "gridPos": { "x": 12, "y": 8, "w": 12, "h": 8 }
    },
    {
      "type": "timeseries",
      "title": "Backend API Error Rate",
      "datasource": { "type": "prometheus", "uid": "prometheus" },
      "targets": [
        {
          "expr": "(sum(rate(http_requests_total{status_code=~\"5..\"}[5m])) / sum(rate(http_requests_total[5m])))",
          "legendFormat": "error_rate"
        }
      ],
      "gridPos": { "x": 0, "y": 16, "w": 12, "h": 8 }
    },
    {
      "type": "table",
      "title": "Tech Revenue Opportunity Tasks",
      "datasource": { "type": "postgres", "uid": "supabase" },
      "targets": [
        {
          "format": "table",
          "rawSql": "SELECT\n  t.id,\n  t.title,\n  t.status,\n  t.priority,\n  t.due_date,\n  t.created_at\nFROM tasks t\nJOIN brands b ON t.brand_id = b.id\nWHERE b.slug = 'tech'\n  AND (t.meta->>'tag') = 'revenue_opportunity'\nORDER BY t.priority DESC, t.due_date NULLS LAST;",
          "refId": "A"
        }
      ],
      "gridPos": { "x": 12, "y": 16, "w": 12, "h": 8 }
    }
  ]
}
